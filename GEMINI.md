# CodeSmithプロジェクト

CodeSmithは、フローチャートを簡単作成できるビジュアルプログラミング環境です。PythonアプリケーションとしてGUI、フレーム・ブロック管理、JSON保存・読込機能を搭載。

## 機能

### インターフェース
- モダンなダークテーマのGUI
- 3つの主要セクション：
    -メニューバー（左端）
    -サイドバー（左側）
    -メインバー（右側）

### 主要機能
1.  **フレーム・ブロック管理**
    - フレームの追加と管理
    - ブロック内でのテキスト編集

2.  **ファイル操作**
    - JSON形式（.json）でのデータの保存と読み込み

3.  **ユーザーインターフェース**
    - マウスホイールによるスクロール
    - フレーム・ブロックの選択状態の視覚的フィードバック

## はじめに

1.  **プログラムの実行**
    - メインだけで実行： `python maincode/CodeSmith.py`
    - 全体を実行： `./run.bat`

## 使用方法

1.  **メニューバーの操作**
    - **ファイルアイコン**: ファイル操作メニューを表示します。
    - **ブロックアイコン**: ブロック操作メニューを表示します。

2.  **フレーム・ブロックの作成**
    - **フレーム追加**: 「frame」ボタンをクリックします。
    - **ブロック追加**: 「block」ボタンをクリックします。
    - フレーム内でブロックを選択して編集します。

3.  **ファイルの保存と読み込み**
    - **JSONファイルに保存**: 「Save File」
    - **JSONファイルから読み込み**: 「Open File」

## プロジェクト構造
```
CodeSmith Project/
├── README.md
├── GEMINI.md
├── run.bat
├── .editorconfig
├── desktop.ini
├── maincode/
│   └── CodeSmith.py
├── image/
│   └── menubar/
│       ├── block_icon.png
│       └── file_icon.png
├── test_json/
├── .venv/
├── .venv_old/
│   └── Scripts/
├── .vscode/
│   ├── extensions.json
│   └── settings.json
├── CodeSmith_ai_agent/
│   ├── app/
│   │   └── __pycache__/
│   │       ├── __init__.cpython-313.pyc
│   │       └── server.cpython-313.pyc
│   └── packages/
└── docs/
    └── requirements_and_improvements.md
```

## ルール
- この内容やプロジェクト構成・各種仕様が変更された場合は、必ずGEMINI.mdを最新化すること
- 自動更新時は必ずレビュー（内容チェック）を実施し、手動でも修正可能
- コードを生成するとき、必ずユーザーの書き方にそって生成してください。もしそのユーザーの書き方より明らかによい方法があったらユーザーに伝えてください。
- ユーザーがこのチャットを終わるというような内容を言ったら必ずGEMINI.mdを最新化にして自動更新時は必ずレビュー（内容チェック）を実施し、手動でも修正可能にして。また、gitで[git status]でgitの状態が正常であるか確認します。そのあとユーザーがいるブランチに[git add .]と書いて。さらに「commit -m ""（「""」で作業の成果を一二行で簡潔に書いて。）」という内容を[WriteFile]で書いてユーザーにチェックをお願いしてください。（検証からpowershellでないとコミットメッセージが文字化けになるため一応ユーザーにそのことをいうこと。）そのあと[cursor maincode/""]（""はWriteFileで作成したファイル）を実行してください。そのあとユーザーがそのファイルを書いた内容をコピペしてコミットを実行します。ユーザーがコミットをするのを忘れないように注意はしてください。また、もしコードに節目が出来たらユーザーにpushの提案をしてください。もしユーザーがpushの提案に許可を出したらこのコマンドを打ってください。[git push origin "現在のユーザーのブランチ"]
- わからないならわからないと言ってください。（ハルシネーション防止）
- 単語などを聞いてきた場合必ずgoogle検索で複数信頼できるサイトをしらべて教えて。ほかにもgoogle検索を使わなければならない状況になったら同じように使って。
- レビューなどとかに限らず忖度はなしではっきり言ってください。
- 複雑な命令は時間はとっていいからちゃんと一個ずつその命令を達成するために考えて。
- 簡単な質問や命令は早く答えて。
- 基本的に全部日本語で。
- 番号順で書くときは必ず途中で途切れないようにして。
- ユーザーがコードのお願いをしたりコードを使ってなにかをする場合まず最初に[ReadFile]で現在のコードを確認すること。


---

## 変更履歴

### 2025年10月6日
- **フレーム選択機能の実装 (`maincode/CodeSmith.py`):**
    - フレーム (`QtFrame`) をクリックすることで、そのフレームを選択状態（青い枠線でハイライト）にできるように変更。
    - フレーム以外の領域をクリックすると、選択が解除されるように実装。
- **汎用クリックイベント処理の検討 (`maincode/CodeSmith.py`):**
    - `mousePressEvent` を、任意のウィジェット(`search_widget`)範囲外のクリックを検知する汎用的な実装に変更する試みが行われた。
    - この実装は、呼び出し先の `select_search_widget` メソッドが未定義であるため、現状では不完全な状態。

### 2025年10月5日
- **`run.bat`の改善:**
    - `pause`コマンドを削除し、実行後に待機しないように変更。
    - `start /b`を使用し、アプリケーションがバックグラウンドで実行されるように修正。これにより、コマンドプロンプトをブロックせずにアプリを起動できるようになった。
- **UIの改善 (`maincode/CodeSmith.py`):**
    - サイドバーのボタンにスタイルを適用し、視覚的に分かりやすいデザインに変更。
    - スタイルの競合問題を解決し、色が正しく表示されるように修正。
    - ボタンの背景色を変数 (`self.sidebar_button_color`) で管理するようにリファクタリングし、メンテナンス性を向上。